{% from "nodemacro.html" import show_node %}

<!DOCTYPE html>
<html lang="en">
<title>MDGS - {{file}}</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<link rel="stylesheet" href="/mdgs/static/w3.css">
<link rel="stylesheet" href="/mdgs/static/style.css" type="text/css">
<link rel="stylesheet" href="/mdgs/static/codehilite.css" type="text/css">
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"
  integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

<script src="/mdgs/static/fontawesome.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/holmes.js/1.17.3/js/holmes.js"></script>

<style>
  .hidden {
    display: none;
  }
</style>


<body>
  <!-- Left menu -->
  {% include 'leftmenu_search.html' %}

  <!-- Right menu -->
  {% include 'rightmenu.html' %}

  <!-- Content -->
  <div id="content" style="margin-left:340px;margin-right:340px">
    <div id="mdgsStatus">Status: </div>
    <a class="actionbutton" href="/mdgs/history/{{file}}"><i class="fas fa-clipboard-list"></i> History</a> <a
      class="actionbutton" href="/mdgs/edit/FWGenDoc/{{file}}"><i class="far fa-edit"></i> Edit</a> <a
      class="actionbutton" href="/mdgs/pdf/FWGenDoc/{{file}}"><i class="far fa-file-pdf"></i> PDF</a> <a href="#"
      class="actionbutton" onclick="fetch('/mdgs/pullRepo')"><i class="fas fa-arrow-down"></i> PullRepo</a>
    <div id="mdcontent">
      {% autoescape false %}
      {{ html }}
      {% endautoescape %}
    </div>
  </div>

  <script src="/mdgs/static/script.js"></script>

</body>

<script>
  var customMatching = function (htmlText, search) {
    var regex = new RegExp(search);
    return regex.test(htmlText);
  }
  var found = function (placeholder) {
    console.log("found");
  }
  holmes({ dynamic: false, minCharacters:3, shouldShow: customMatching, onInput: oninput, mark:true, find: 'p, li, h1, h2, h3, h4, h5, table' });

  function oninput(input) {
    const d = new Date();
    var fs = document.getElementsByClassName("fileclass");
    for (let i = 0; i < fs.length; i++) {
      var f =fs[i]
      var siblings = [];
      elem = f.nextElementSibling;
      while (elem) {
        f.classList.remove("hidden");

        if (elem.matches("br")) elem.classList.add("hidden");
        if (elem.matches("hr")) elem.classList.add("hidden");
        if (!elem.matches(".hidden")){
          if (elem.matches("p")) break;
          if (elem.matches("li")) break;
          if (elem.matches("h1")) break;
          if (elem.matches("h2")) break;
          if (elem.matches("h3")) break;
          if (elem.matches("h4")) break;
          if (elem.matches("h5")) break;
          if (elem.matches("table")) break;
        }
        
        if (elem.matches(".fileclass")) {
          f.classList.add("hidden");
          break;
        } 

        siblings.push(elem);
        elem = elem.nextElementSibling;
      }
    } 
  }

</script>

</html>